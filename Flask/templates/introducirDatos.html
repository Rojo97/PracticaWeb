 {% extends "layout.html" %} {% block head %} {{ super() }} {% endblock %} {% block content %}
<div class="wrapper" id="app">

    <menulateral current_user="{{current_user}}"></menulateral>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Escribir dentro de este div para añadir cosas a la plantilla -->

        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                Introducir datos
            </h1>
            <ol class="breadcrumb">
                <li>
                    <a href="#">
                        <i class="fa fa-dashboard"></i> Home</a>
                </li>
                <li class="active">Introducir datos</li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">
            <div class="row">
                <div class="col-md-12">
                    <div class="box box-primary" style="padding-bottom:1%; padding-top:1%; padding-left:1%; padding-right:1%;">
                        <div class="tab-content">
                            <div class="active tab-pane" id="activity">
                                <div class="box-body">
                                    <div class="form-group">
                                        <label>Sensor</label>
                                        <select class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" v-model="id">
                                            <option v-for="sensor in sensores" :key="sensor.id" v-bind:value='sensor.id'>[[sensor.name]]</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Valor</label>
                                        <input type="text" class="form-control" id="sensorValue" placeholder="Valor del sensor" v-model="value">
                                    </div>
                                    <div class="form-group">
                                        <label>Fecha y hora</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-calendar"></i>
                                            </div>
                                            <input type="date" class="form-control" id="sensorDate" v-model="date">
                                        </div>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-clock-o"></i>
                                            </div>
                                            <input type="time" class="form-control timepicker" id="sensorTime" v-model="time">
                                        </div>
                                        <div class="box-footer">
                                            <button @click="createMeasure" :disabled="inactivo" type="submit" class="btn btn-success">Añadir medida</button>
                                        </div>
                                    </div>
                                </div>
                                <!-- /.tab-content -->
                            </div>
                            <!-- /.nav-tabs-custom -->
                        </div>
                    </div>
        </section>
        <!-- /.content -->

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Create the tabs -->
            <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
                <!-- Home tab content -->
                <div id="control-sidebar-home-tab">
                    </form>
                </div>
                <!-- /.tab-pane -->
            </div>
        </aside>
        </div>
        <!-- ./wrapper -->
        </div>
        {% endblock %} {% block javascripts %}{{ super() }}
        <script>
            var socket = io.connect('{{ domain }}');
            var app = new Vue({
                el: "#app",
                delimiters: ['[[', ']]'],
                data: {
                    id: '',
                    value: '',
                    date: '',
                    time: '',
                    sensores: [
                        {% for sensor in sensores %}
	    		    {
                    id: '{{ sensor.disID }}',
                    name: '{{ sensor.nombre }}'
                }{% if not loop.last %}, {% endif %}
            {% endfor %}
            ]
        },
            computed: {
                inactivo() {
                    if (this.id == '' || this.value == '' || this.date == '' || this.time == '') {
                        return true;
                    }
                }
            },
            methods: {
                createMeasure() {
                    socket.emit('createMeasure', {
                        id: this.id,
                        value: this.value,
                        date: this.date,
                        time: this.time
                    });
                },
            }
        });
        </script> {% endblock %}